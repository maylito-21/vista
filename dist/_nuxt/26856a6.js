(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{324:function(t,e,r){var content=r(470);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(113).default)("081c387e",content,!0,{sourceMap:!1})},469:function(t,e,r){"use strict";r(324)},470:function(t,e,r){var o=r(112)((function(i){return i[1]}));o.push([t.i,".showModal{display:block;opacity:1!important;visibility:visible}",""]),o.locals={},t.exports=o},501:function(t,e,r){"use strict";r.r(e);r(48),r(41),r(15),r(85),r(47),r(312),r(210);var o=r(10),n=(r(64),r(32),r(33),r(316),r(214),{head:function(){return{title:this.modulo}},data:function(){return{pago:0,modulo:"Nueva venta",page:"Ventas",buscar:"",marca:"all",categoria:"all",load:!0,image:!0,modalEdit:!1,articulos:[],marcas:[],categorias:[],carrito:[],sucursals:[],item:{articulo:{nombre:""},cantidad:0,precio:0},sucursal:{},impresionAutomatica:0}},computed:{cambio:function(){return this.pago>this.totalCarrito?this.pago-this.totalCarrito:0},articulosFilter:function(){var t=this.buscar;return""!=t?this.articulos.filter((function(a){var e=null!=a.nombre?a.nombre:"",r=null!=a.barra?a.barra:"";return-1!=e.toLowerCase().indexOf(t.toLowerCase())||-1!=r.toLowerCase().indexOf(t.toLowerCase())})):this.articulos},articulosMarca:function(){var t=this.marca;return"all"!=t?this.articulosFilter.filter((function(a){return a.marca_id==t})):this.articulosFilter},articulosCategoria:function(){var t=this.categoria;return"all"!=t?this.articulosMarca.filter((function(a){return a.categoria_id==t})):this.articulosMarca},totalCarrito:function(){return this.carrito.reduce((function(a,b){return a+b.cantidad*b.precio}),0)}},methods:{prueba:function(){alert("PRUEBA ALERT")},GET_DATA:function(path){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.$get(path);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))()},Datos:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.GET_DATA("marcas"),t.GET_DATA("categorias"),t.GET_DATA("inventarios"),t.GET_DATA("sucursals")]).then((function(e){t.marcas=e[0],t.categorias=e[1],t.articulos=e[2],t.sucursals=e[3],t.sucursals.length>0&&(t.sucursal=t.sucursals[0],t.impresionAutomatica=t.sucursals[0].automatica)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},AddCarrito:function(t){var e=t.id;if(this.carrito.filter((function(i){return i.articulo.id==e})).length>0){var r=this.carrito.findIndex((function(i){return i.articulo.id==e}));if(this.carrito[r].cantidad+1>this.carrito[r].stock)return!1;this.carrito[r].cantidad+=1}else{var o={articulo:t,cantidad:1,stock:t.stock,precio:t.venta};this.carrito.push(o)}},EliminarItem:function(i){this.carrito.splice(i,1)},Codebar:function(){var code=this.buscar,t=this.articulosCategoria.filter((function(i){return i.barra==code}));t.length>0&&(this.AddCarrito(t[0]),this.buscar="")},Save:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r,n,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t.pago||0!=t.totalCarrito){e.next=4;break}t.$swal.fire({title:"¡Atención!",text:"No hay artículo para vender",icon:"info"}),e.next=35;break;case 4:if(0!=t.pago){e.next=8;break}t.$swal.fire({title:"¡Atención!",text:"Digita el efectivo",icon:"info"}),e.next=35;break;case 8:if(!(t.pago<t.totalCarrito)){e.next=12;break}t.$swal.fire({title:"¡Atención!",text:"El efectivo no puede menor que el total",icon:"info"}),e.next=35;break;case 12:return t.load=!0,r=t,e.prev=14,n={total:t.totalCarrito,tipo:1,pago:t.pago,cambio:t.cambio,vendedor:t.user.nombre,motivo:"",cliente:"Público general",caja_id:t.user.caja_id,carrito:t.carrito},e.next=18,t.$api.$post("ventas",n);case 18:if(c=e.sent,console.log(c),1!=t.impresionAutomatica){e.next=25;break}return e.next=23,t.ImprimirVenta(c);case 23:e.next=26;break;case 25:t.impresionAutomatica;case 26:t.$swal.fire({icon:"success",title:"Venta Guardada !"}).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isConfirmed){t.next=6;break}return r.CleanDos(),r.load=!0,t.next=5,r.Datos();case 5:r.load=!1;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(14),console.log(e.t0);case 32:return e.prev=32,t.load=!1,e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[14,29,32,35]])})))()},Clean:function(){var t=this;if(0==this.carrito.length)this.$swal.fire({title:"¡Atención!",text:"No hay artículos de venta",icon:"info"});else{this.$swal.fire({title:"Atención",text:"¿Está a punto de perder la información?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar"}).then((function(e){if(e.isConfirmed){t.carrito=[];t.$swal.fire({icon:"success",title:"Registros eliminados",text:"SIGESCO",showConfirmButton:!1,timerProgressBar:!0,timer:2e3})}}))}},CleanDos:function(){this.carrito=[],this.pago=0},ImprimirVenta:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(o=e.sucursal).venta=t,r.next=4,e.$printer.$post(o.impresora_url+"venta",o);case 4:n=r.sent,console.log(n);case 6:case"end":return r.stop()}}),r)})))()},exacto:function(){if(0!=this.totalCarrito)return this.pago=this.totalCarrito,this.pago;this.$swal.fire({title:"¡Atención!",text:"No hay artículos de venta",icon:"info"})}},mounted:function(){var t=this,e=localStorage.getItem("userAuth");this.user=JSON.parse(e),this.$nextTick(Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.Datos();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:return e.prev=8,t.load=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,5,8,11]])}))))}}),c=n,l=(r(469),r(46)),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("div",[e("JcLoader",{attrs:{load:t.load}}),t._v(" "),e("AdminTemplate",{attrs:{page:t.page,modulo:t.modulo}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("div",{staticClass:"row justify-content-end"},[e("div",{staticClass:"col-12 col-sm-7"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"card bg-gradient-dark"},[e("div",{staticClass:"card-header bg-transparent py-2 px-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-4 col-md-6 col-12"},[e("div",{staticClass:"input-group input-group-lg"},[e("span",{staticClass:"input-group-text text-white bg-transparent border-0"},[e("i",{staticClass:"ni ni-archive-2 text-lg",attrs:{"aria-hidden":"true"}})]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.buscar,expression:"buscar"}],staticClass:"form-control bg-transparent border-0 text-white",attrs:{type:"text",placeholder:"Buscar..."},domProps:{value:t.buscar},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.Codebar()},input:function(e){e.target.composing||(t.buscar=e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"col-lg-6 col-md-6 col-12 my-auto ms-auto"},[e("div",{staticClass:"input-group input-group-lg"},[e("span",{staticClass:"input-group-text text-white bg-transparent border-0"},[e("i",{staticClass:"ni ni-box-2 text-lg",attrs:{"aria-hidden":"true"}})]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.marca,expression:"marca"}],staticClass:"form-control bg-transparent border-0 text-white",attrs:{name:"",id:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.marca=e.target.multiple?r:r[0]}}},[e("option",{staticClass:"text-dark",attrs:{value:"all"}},[t._v("\n                            Todas las marcas\n                          ")]),t._v(" "),t._l(t.marcas,(function(r){return e("option",{staticClass:"text-dark",domProps:{value:r.id}},[t._v(t._s(r.nombre))])}))],2)])]),t._v(" "),e("div",{staticClass:"d-flex mb-3"},[e("div",{staticClass:"form-check form-switch ms-auto"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.image,expression:"image"}],staticClass:"form-check-input",attrs:{checked:"",type:"checkbox",title:"Mostrar imágenes del producto"},domProps:{checked:Array.isArray(t.image)?t._i(t.image,null)>-1:t.image},on:{change:function(e){var r=t.image,o=e.target,n=!!o.checked;if(Array.isArray(r)){var c=t._i(r,null);o.checked?c<0&&(t.image=r.concat([null])):c>-1&&(t.image=r.slice(0,c).concat(r.slice(c+1)))}else t.image=n}}})])])])])])]),t._v(" "),e("div",{staticClass:"col-12 py-2",staticStyle:{"min-height":"55vh","max-height":"55vh","overflow-y":"scroll","overflow-x":"none"}},[e("div",{staticClass:"row"},[t._l(t.articulosCategoria,(function(r){return[r.stock>0?e("div",{staticClass:"col-6 col-md-4 col-lg-3"},[1==t.image?e("PosArticulo-venta",{attrs:{articulo:r},on:{AddCarrito:t.AddCarrito}}):e("PosArticulo-venta-image",{attrs:{articulo:r},on:{AddCarrito:t.AddCarrito}})],1):t._e()]}))],2)]),t._v(" "),e("div",{staticClass:"col-xl-12"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body d-flex p-3"},[e("h6",{staticClass:"my-auto"},[t._v("Categoría")]),t._v(" "),e("div",{staticClass:"nav-wrapper position-relative ms-auto w-50"},[e("ul",{staticClass:"nav nav-pills nav-fill p-1",attrs:{role:"tablist"}},[e("li",{staticClass:"nav-item active",attrs:{role:"presentation"}},[e("a",{staticClass:"nav-link mb-0 px-0 py-1",attrs:{"data-bs-toggle":"tab",href:"#cam1",role:"tab","aria-controls":"cam1","aria-selected":"true"}})])])]),t._v(" "),e("div",{staticClass:"dropdown pt-2"},[e("a",{staticClass:"text-secondary ps-4",attrs:{href:"javascript:;",id:"dropdownCam","data-bs-toggle":"dropdown","aria-expanded":"false",title:"Filtro categorías"}},[e("i",{staticClass:"fas fa-ellipsis-v",attrs:{"aria-hidden":"true"}})]),t._v(" "),e("ul",{staticClass:"dropdown-menu dropdown-menu-end me-sm-n4 px-2 py-3",attrs:{"aria-labelledby":"dropdownCam"}},[e("li",[e("a",{staticClass:"dropdown-item border-radius-md",attrs:{href:"javascript:;"},on:{click:function(e){t.categoria="all"}}},[t._v("Todo")])]),t._v(" "),t._l(t.categorias,(function(r){return e("li",[e("a",{staticClass:"dropdown-item border-radius-md",attrs:{href:"javascript:;"},on:{click:function(e){t.categoria=r.id}}},[t._v(t._s(r.nombre))])])}))],2)])])])])])]),t._v(" "),e("div",{staticClass:"col-sm-5"},[e("div",{staticClass:"card card-pricing"},[e("div",{staticClass:"card-header bg-gradient-dark text-center pt-4 pb-5 position-relative"},[e("div",{staticClass:"z-index-1 position-relative"},[e("h1",{staticClass:"text-white mt-2 mb-0"},[e("small"),t._v(t._s(t._f("currency")(Number(t.totalCarrito).toFixed(2),"$"))+"\n                ")]),t._v(" "),e("h6",{staticClass:"text-white"},[t._v("Total de venta")])])]),t._v(" "),e("div",{staticClass:"position-relative mt-n5",staticStyle:{height:"50px"}},[e("div",{staticClass:"position-absolute w-100"},[e("svg",{staticClass:"waves waves-sm",attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 24 150 40",preserveAspectRatio:"none","shape-rendering":"auto"}},[e("defs",[e("path",{attrs:{id:"card-wave",d:"M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"}})]),t._v(" "),e("g",{staticClass:"moving-waves"},[e("use",{attrs:{"xlink:href":"#card-wave",x:"48",y:"-1",fill:"rgba(255,255,255,0.30"}}),t._v(" "),e("use",{attrs:{"xlink:href":"#card-wave",x:"48",y:"3",fill:"rgba(255,255,255,0.35)"}}),t._v(" "),e("use",{attrs:{"xlink:href":"#card-wave",x:"48",y:"5",fill:"rgba(255,255,255,0.25)"}}),t._v(" "),e("use",{attrs:{"xlink:href":"#card-wave",x:"48",y:"8",fill:"rgba(255,255,255,0.20)"}}),t._v(" "),e("use",{attrs:{"xlink:href":"#card-wave",x:"48",y:"13",fill:"rgba(255,255,255,0.15)"}}),t._v(" "),e("use",{attrs:{"xlink:href":"#card-wave",x:"48",y:"16",fill:"rgba(255,255,255,0.99)"}})])])])]),t._v(" "),e("div",{staticClass:"card-body text-center p-3",staticStyle:{"min-height":"35vh","max-height":"35vh","overflow-y":"scroll","overflow-x":"none"}},[e("div",{staticClass:"d-flex align-items-center px-2"},[e("h6",[t._v("CARRITO")]),t._v(" "),e("button",{staticClass:"btn btn-icon-only btn-rounded btn-outline-dark mb-0 ms-2 btn-sm d-flex align-items-center justify-content-center ms-auto",attrs:{type:"button",title:"Borrar venta","data-bs-toggle":"tooltip","data-bs-placement":"bottom"},on:{click:function(e){return t.Clean()}}},[e("i",{staticClass:"fas fa-trash",attrs:{"aria-hidden":"true"}})])]),t._v(" "),e("div",{staticClass:"table-responsive p-0",staticStyle:{"min-height":"30vh"}},[e("table",{staticClass:"table align-items-center justify-content-center mb-0"},[e("thead",[e("tr",[e("th",{staticClass:"text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2 text-start"},[t._v("\n                        Artículo\n                      ")]),t._v(" "),e("th",{staticClass:"text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2 text-start"},[t._v("\n                        Cantidad\n                      ")]),t._v(" "),e("th",{staticClass:"text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2 text-start"},[t._v("\n                        Subtotal\n                      ")]),t._v(" "),e("th",{staticClass:"text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2 text-start",staticStyle:{width:"5px"}},[t._v("\n                        Opciones\n                      ")])])]),t._v(" "),e("tbody",t._l(t.carrito,(function(r,i){return e("tr",[e("td",{staticClass:"text-start"},[e("p",{staticClass:"text-xxs font-weight-bold mb-0 text-start"},[t._v("\n                          "+t._s(r.articulo.nombre)+"\n                        ")])]),t._v(" "),e("td",{staticClass:"text-start"},[e("p",{staticClass:"text-xxs font-weight-bold mb-0 text-start"},[t._v("\n                          "+t._s(r.cantidad)+"\n                        ")])]),t._v(" "),e("td",{staticClass:"text-start"},[e("p",{staticClass:"text-xxs font-weight-bold mb-0 text-start"},[t._v("\n                          "+t._s(t._f("currency")(Number(r.cantidad*r.precio).toFixed(2),"$"))+"\n                        ")])]),t._v(" "),e("td",[e("div",{staticClass:"input-group input-group-sm"},[e("button",{staticClass:"btn btn-outline-primary mb-0 btn-sm",attrs:{type:"button",title:"Editar cantidad"},on:{click:function(e){t.modalEdit=!0,t.item=r}}},[e("i",{staticClass:"fas fa-pen"})]),t._v(" "),e("button",{staticClass:"btn btn-outline-danger mb-0 btn-sm",attrs:{type:"button",title:"Eliminar venta"},on:{click:function(e){return t.EliminarItem(i)}}},[e("i",{staticClass:"fas fa-times"})])])])])})),0)])])]),t._v(" "),e("div",{staticClass:"row",staticStyle:{border:"2px","margin-left":"2px","margin-right":"1px"}},[e("div",{staticClass:"col-4",staticStyle:{"padding-left":"30px","padding-right":"30px"}},[e("label",{attrs:{for:""}},[t._v("Exacto:")]),t._v(" "),e("a",{staticClass:"btn bg-primary bg-gradient w-100 mt-4 mb-0",staticStyle:{"margin-top":"1px!important"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.exacto()}}},[e("i",{staticClass:"fas fa-coins",staticStyle:{color:"#ffffff"}})])]),t._v(" "),e("div",{staticClass:"col-4",staticStyle:{"padding-left":"30px","padding-right":"30px"}},[e("label",{attrs:{for:""}},[t._v("Efectivo:")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pago,expression:"pago"}],staticClass:"form-control",attrs:{type:"number",name:"nombre",id:""},domProps:{value:t.pago},on:{input:function(e){e.target.composing||(t.pago=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"col-4"},[e("label",{attrs:{for:""}},[t._v("Cambio:")]),t._v(" "),e("h6",{staticStyle:{"padding-top":"10px"}},[t._v(t._s(t._f("currency")(t.cambio,"$")))])]),t._v(" "),e("a",{staticClass:"btn bg-gradient-dark w-100 mt-4 mb-0",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.Save()}}},[e("i",{staticClass:"fas fa-save mx-2"}),t._v(" GUARDAR\n              ")])])])]),t._v(" "),e("div",{staticClass:"modal fade",class:t.modalEdit?"showModal":"",attrs:{id:"AjusteModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("\n                  Editar artículo\n                ")]),t._v(" "),e("button",{staticClass:"btn-close text-dark",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.modalEdit=!1}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group has-success"},[e("label",{attrs:{for:""}},[t._v("Artículo")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"",disabled:""},domProps:{value:t.item.articulo.nombre}})])]),t._v(" "),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group has-success"},[e("label",{attrs:{for:""}},[t._v("Precio")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.item.precio,expression:"item.precio",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.item.precio},on:{input:function(e){e.target.composing||t.$set(t.item,"precio",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group has-success"},[e("label",{attrs:{for:""}},[t._v("Cantidad")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.item.cantidad,expression:"item.cantidad",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.item.cantidad},on:{input:function(e){e.target.composing||t.$set(t.item,"cantidad",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn bg-gradient-secondary w-100",attrs:{type:"button","data-bs-dismiss":"modal"},on:{click:function(e){t.modalEdit=!1}}},[t._v("\n                  Cerrar\n                ")])])])])])])])])],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{JcLoader:r(306).default,AdminTemplate:r(303).default})}}]);